pipeline {
    agent any

    environment {
        GIT_REPO = 'https://github.com/Danisaac21/mthreeSRE1.git'
        ARTIFACT_NAME = 'fake-artifact'
        INVENTORY_FILE = 'your-inventory.ini' // Path to your Ansible inventory file
        PLAYBOOK_FILE = 'your-playbook.yml' // Path to your Ansible playbook file
    }

    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out source code...'
                git branch: 'main', 
                    credentialsId: '166b7cc0-41a1-4e8e-93d4-ecb1f00ac5b6', 
                    url: GIT_REPO
            }
        }

        stage('Build') {
            steps {
                echo 'Simulating artifact creation...'
        sh '''
            echo "This is a simulated artifact" > fake-file.txt
            zip fake-artifact.zip fake-file.txt
        '''
            }
        }

        stage('Archive Artifact') {
            steps {
                echo 'Archiving build artifact...'
                archiveArtifacts artifacts: "fake-artifact.zip", allowEmptyArchive: false
            }
        }

        stage('Deploy with Ansible') {
            steps {
                 echo 'Simulating deployment to local system...'
        sh '''
            mkdir -p /tmp/deployment
            cp target/${ARTIFACT_NAME}.zip /tmp/deployment/
            echo "Simulated deployment complete!"
        '''
                )
            }
        }
    }

    post {
        success {
            echo 'Deployment completed successfully!'
        }
        failure {
            echo 'Deployment failed. Check logs for details.'
        }
    }
}
